# Teleprompter Design Document

## 1. 目标

本项目目标是提供一个轻量、可离线运行的单页提词器，满足以下核心需求：
- 用户输入提词文本
- 文本在独立展示区自动向上滚动
- 展示区具备透明感和上下渐隐视觉效果
- 用户可实时调整滚动速度

## 2. 范围与边界

当前版本范围：
- 单文件实现（HTML + CSS + JavaScript）
- 本地浏览器直接打开即可运行
- 基础播放控制（开始、暂停、重置）

暂不包含：
- 文本文件导入/导出
- 多主题切换
- 远程同步
- 分段跳转与标记点

## 3. 页面结构

文件：`teleprompter.html`

主要区域：
- 控制区（`.controls`）
- 提词展示区（`.teleprompter`）

关键元素：
- `#sourceText`：输入提词内容
- `#startBtn` / `#pauseBtn` / `#resetBtn`：播放控制
- `#speedRange` + `#speedValue`：速度调节与显示
- `#content`：可滚动容器
- `#displayText`：实际展示文本

## 4. 视觉设计

设计原则：
- 高可读性：大字号、宽行距
- 低干扰：隐藏滚动条，保留简洁控件
- 透明感：展示区半透明背景 + 渐隐蒙层

关键实现：
- 背景采用渐变色，减少纯色大面积疲劳感
- `::before` / `::after` 创建顶部和底部渐隐区域
- 文本增加轻微阴影，提升复杂背景下识别度

## 5. 滚动机制

滚动采用 `requestAnimationFrame`（RAF）驱动，而非 `setInterval`：
- 刷新节奏由浏览器调度，动画更平滑
- 通过时间差 `deltaSec` 进行速度积分，保证“像素/秒”语义稳定

公式：
- 每帧位移 = `speed * deltaSec`
- `speed` 来源于滑块数值（单位：px/s）

停止条件：
- 当 `scrollTop >= scrollHeight - clientHeight` 时自动停止

## 6. 状态管理

核心状态变量：
- `isRunning`：是否正在滚动
- `speed`：当前滚动速度
- `lastTime`：上一帧时间戳
- `rafId`：当前动画帧 ID，用于取消动画

行为说明：
- `start()`：若未运行，则启动 RAF
- `pause()`：停止滚动并取消当前 RAF
- `reset()`：暂停后回到顶部

## 7. 文本同步策略

输入框变化时：
1. 先计算当前阅读进度比例
2. 同步新文本到展示区
3. 按新内容高度恢复接近原进度位置

意义：
- 避免编辑文本后滚动位置突变
- 提升演讲排练场景下的连续性

## 8. 响应式与兼容性

已考虑：
- 控件区域支持换行，适配窄屏
- 字号使用 `clamp`，兼顾手机与桌面
- 隐藏滚动条时覆盖主流浏览器写法

建议运行环境：
- Chrome / Edge / Firefox 新版本

## 9. 可扩展路线

建议优先级：
1. 快捷键支持（空格开始/暂停、上下键调速）
2. 镜像模式（演播提词器常用）
3. 字号与行距调节
4. 本地存储（自动保存最近一次内容与速度）
5. 多稿件管理（场景切换）

## 10. 测试清单（手工）

建议每次改动后最少验证：
- 输入较长文本后可连续滚动到底
- 速度滑块变化后，滚动速度即时变化
- 暂停后继续播放位置正确
- 重置后回到顶部
- 移动端与桌面端显示正常
